# 关于如何使用本项目的日志组件

## 日志组件概述

日志组件基于zap库进行进一步封装，日志组件代码位于`dto/logger.go`由于涉及循环引用，所以暂时将文件放置于`dto`目录下，日志记录的格式为每次记录一行，每行都是一个json格式的字符串

日志组件将记录3种情况的日志

1. 接口访问日志，请求接口时，默认将会记录下相关的访问信息，如所访问的接口、返回值、请求时间等
2. panic所触发的报错，日志组件将会掩盖掉panic错误，将不再因为panic而导致程序终止
3. 人为增加日志，在代码重使用类似于`logger.Info()`的函数来记录日志

## 使用方法

在整个项目的绝大多数地方，使用`dto.WriteLog()`函数即可记录日志，此函数主要有如下参数

- 第一个参数：日志类型，目前支持info、warn、error共3个类型的日志记录，此参数必须为三者之一，填写三者之外的内容，将默认记录为info类型的日志
- 第二个参数：日志主要信息，此字段为一个字符串，为当前日志的概括信息
- 第3到n个参数：对日志进行特殊化的记录，例如记录一些关键参数的值；第3到n个参数必须是偶数个参数，且第`3+k`个参数和第`3+k+1`个参数为一组，分别为键和值；目前此参数只支持`string`类型

### 具体使用

```golang
dto.WriteLog(
    "info", "Log test",
    "key1", "value1",
    "key2", "value2",
)
```

在上述实列中，`"info"`和`"Log test"`分别对应上述描述的第1和第2个参数，从`"key1"`开始是第`3+k`个参数，分别与`3+k+k`个参数一一对应

上述代码记录的日志如下（经过格式化处理的日志）

```json
{
    "level": "info",
    "msg": "Log test",
    "key1": "value1",
    "key2": "value2"
}
```

## 推荐使用方式

在编写代码的过程中，对错误的处理和记录多使用`dto.WriteLog()`函数记录而不是`panic()`，使用`dto.WriteLog()`可以更准确的记录调用日志记录函数的文件和行号
